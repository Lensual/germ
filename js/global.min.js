function refresh_qrimg(){$("#qrimg").attr("src","https://api.lwl12.com/img/qrcode/get?ct="+location.href+"&w=140&h=140")}function initgallary(){$(".flexslider").flexslider({animation:"slide",controlNav:"thumbnails",smoothHeight:!0,touch:!0})}function closeMobileSidebar(){$("body").removeClass("has-opened"),$("#mobile-nav").hide("fast")}function add_views(){var e=jQuery("#content>div>article");if(1==e.length){e=e.attr("class");var t=e.match(/post-([0-9]*)/);if(!(null===t||t.length<2)){var n=t[1],o={action:"add_views",post_ID:n};jQuery.post(ajax.ajax_url,o)}}}window.$=jQuery,window.favorite_link_init=function(){jQuery(".favorite").click(function(){var e=jQuery(this).children(".love-count"),t=jQuery(this).children(".fa");if(jQuery(this).hasClass("done"))return e.html("已经点过赞啦"),t.hide().fadeIn(500),!1;jQuery(this).addClass("done"),t.hide().fadeIn(700),e.hide().fadeIn(300);var n=+e.html();e.html("谢谢喜欢"),setTimeout(function(){e.html(n+1)},2e3);var o=jQuery(this).data("id"),i=jQuery(this).data("action"),a={action:"mzw_like",um_id:o,um_action:i};return jQuery.post(window.ajax.ajax_url,a),!1})},window.favorite_link_init(),jQuery.fn.typing=function(e){function t(){o.html(l.substr(0,r)),r>=l.length?(s=-1,setTimeout(t,a.show)):r<=0?(s=1,setTimeout(t,a.speed),i&&d!=l&&(l=d,n())):s>0?setTimeout(t,a.speed):setTimeout(t,a.delSpeed),r+=s}function n(){$.get("https://api.hzy.pw/saying/v1/ciba",function(e){d=e.cnFix}).fail(function(){setTimeout(n,2e3)})}var o=$(this),i=o.hasClass("saying-title");if(i){var a={speed:200,delSpeed:100,show:5e3};$.extend(a,e);var r=1,s=1;o.css("border-right","1px solid #000");var l=$(this).text().trim(),d=l;setTimeout(t,a.speed),n()}},$(window).width()>650&&$("#header .desc span").typing({show:3e3}),jQuery(document).ready(function(e){function t(){$new_comm.show(),$new_sucs.show(),e("textarea").each(function(){this.value=""}),a=""}function o(){y>0?(v.val(y),y--,setTimeout(o,1e3)):(v.val(_).attr("disabled",!1).fadeTo("slow",1),y=15)}function i(){var t="",n=e("#comment").val(),o=n.indexOf("<code>"),i=n.indexOf("</code>");if(o>-1&&i>-1&&o<i)for(t="";i!=-1;)t+=n.substring(0,o+6)+n.substring(o+6,i).replace(/<(?=[^>]*?>)/gi,"&lt;").replace(/>/gi,"&gt;"),n=n.substring(i+7,n.length),o=n.indexOf("<code>")==-1?-6:n.indexOf("<code>"),i=n.indexOf("</code>"),i==-1?(t+="</code>"+n,e("#comment").val(t)):o==-6?myFielde+="&lt;/code&gt;":t+="</code>";var n=t?t:e("#comment").val(),t="",o=n.indexOf("<pre>"),i=n.indexOf("</pre>");if(o>-1&&i>-1&&o<i)for(t=t;i!=-1;)t+=n.substring(0,o+5)+n.substring(o+5,i).replace(/<(?=[^>]*?>)/gi,"&lt;").replace(/>/gi,"&gt;"),n=n.substring(i+6,n.length),o=n.indexOf("<pre>")==-1?-5:n.indexOf("<pre>"),i=n.indexOf("</pre>"),i==-1?(t+="</pre>"+n,e("#comment").val(t)):o==-5?myFielde+="&lt;/pre&gt;":t+="</pre>"}e("#main-nav li.menu-item-has-children").hover(function(){e(this).find(".sub-menu").stop().show("normal")},function(){e(this).find(".sub-menu").stop().hide("normal")});var a,r=(e("#commentform"),'<div id="loading"><i class="fa fa-circle-o-notch fa-spin"></i> 正在提交, 请稍候...</div>'),s='<div id="error">#</div>',l='">提交成功',d=', 刷新页面之前可以<a rel="nofollow" class="comment-reply-link" href="#edit" onclick=\'return addComment.moveForm("',c=")'>重新编辑</a>",m="取消编辑",u=1,p=e("#comments-title span"),h=e("#cancel-comment-reply-link"),f=h.text(),v=e("#commentform #submit");v.attr("disabled",!1),$body=e(window.opera?"CSS1Compat"==document.compatMode?"html":"body":"html,body"),comm_array=[],comm_array.push(""),e("#comment").after(r+s),e("#loading").hide(),e("#error").hide(),e(document).on("submit","#commentform",function(){return a&&e("#comment").after('<input type="text" name="edit_id" id="edit_id" value="'+a+'" style="display:none;" />'),i(),v.attr("disabled",!0).fadeTo("slow",.5),e("#loading").slideDown(),e.ajax({url:ajax.ajax_url,data:e(this).serialize()+"&action=ajax_comment",type:e(this).attr("method"),error:function(t){e("#loading").hide(),e("#error").slideDown().html(t.responseText),setTimeout(function(){v.attr("disabled",!1).fadeTo("slow",1),e("#error").slideUp()},3e3)},success:function(t){e("#loading").hide(),comm_array.push(e("#comment").val()),e("textarea").each(function(){this.value=""});var i=addComment,r=i.I("cancel-comment-reply-link"),s=i.I("wp-temp-form-div"),m=i.I(i.respondId),h=i.I("comment_post_ID").value,f=i.I("comment_parent").value;!a&&p.length&&(n=parseInt(p.text().match(/\d+/)),p.text(p.text().replace(n,n+1))),new_htm='" id="new_comm_'+u+'"></',new_htm="0"==f?'\n<ol style="clear:both;" class="commentlist'+new_htm+"ol>":'\n<ul class="children'+new_htm+"ul>",ok_htm='\n<div class="ajax-notice" id="success_'+u+l,div_=document.body.innerHTML.indexOf("div-comment-")==-1?"":document.body.innerHTML.indexOf("li-comment-")==-1?"div-":"",ok_htm=ok_htm.concat(d,div_,"comment-",f,'", "',f,'", "respond", "',h,'", ',u,c),ok_htm+="</span><span></span>\n",ok_htm+="</div>\n",e("#respond").before(new_htm),e("#new_comm_"+u).append(t),e("#new_comm_"+u+" li").append(ok_htm),$body.animate({scrollTop:e("#new_comm_"+u).offset().top-200},900),o(),u++,a="",e("*").remove("#edit_id"),r.style.display="none",r.onclick=null,i.I("comment_parent").value="0",s&&m&&(s.parentNode.insertBefore(m,s),s.parentNode.removeChild(s))}}),!1}),addComment={moveForm:function(n,o,i,r,s){var l,d=this,c=d.I(n),u=d.I(i),p=d.I("cancel-comment-reply-link"),v=d.I("comment_parent"),y=d.I("comment_post_ID");a&&t(),s?(d.I("comment").value=comm_array[s],a=d.I("new_comm_"+s).innerHTML.match(/(comment-)(\d+)/)[2],$new_sucs=e("#success_"+s),$new_sucs.hide(),$new_comm=e("#new_comm_"+s),$new_comm.hide(),h.text(m)):h.text(f),d.respondId=i,r=r||!1,d.I("wp-temp-form-div")||(l=document.createElement("div"),l.id="wp-temp-form-div",l.style.display="none",u.parentNode.insertBefore(l,u)),c?c.parentNode.insertBefore(u,c.nextSibling):(temp=d.I("wp-temp-form-div"),d.I("comment_parent").value="0",temp.parentNode.insertBefore(u,temp),temp.parentNode.removeChild(temp)),$body.animate({scrollTop:e("#respond").offset().top-180},400),y&&r&&(y.value=r),v.value=o,p.style.display="",p.onclick=function(){a&&t();var e=addComment,n=e.I("wp-temp-form-div"),o=e.I(e.respondId);return e.I("comment_parent").value="0",n&&o&&(n.parentNode.insertBefore(o,n),n.parentNode.removeChild(n)),this.style.display="none",this.onclick=null,!1};try{d.I("comment").focus()}catch(e){}return!1},I:function(e){return document.getElementById(e)}};var y=15,_=v.val()}),$(document).on("click",".post-share>a",function(e){return e.preventDefault(),$(this).parent().hasClass("share-on")?($(this).parent().removeClass("share-on"),$(this).next().hide()):($(this).parent().addClass("share-on"),$(this).next().show()),!1}),$(document).on("click",".post-share ul li a",function(e){$(this).parent().parent().parent().removeClass("share-on"),$(this).parent().parent().hide()});var ajaxBinded=!1;$(document).ready(function(e){initgallary(),refresh_qrimg(),$("#qr").hover(function(){$("#qrimg").stop().fadeIn("normal")},function(){$("#qrimg").stop().fadeOut("normal")})}),jQuery(window).scroll(function(){jQuery(this).scrollTop()>100?jQuery("#gotop").css({bottom:"110px"}):jQuery("#gotop").css({bottom:"-110px"})}),jQuery("#gotop").click(function(){return jQuery("body,html").animate({scrollTop:0},800),!1});var rollbox=$("#sidebar .widget"),rolllen=rollbox.length,asr_1=parseInt(ajax.fly1),asr_2=parseInt(ajax.fly2);if(asr_1!==-24&&asr_2!==-38&&0!==rolllen&&"none"!==$("#sidebar").css("display")){var sidebar_flying=!1;$(window).scroll(function(){var e=document.documentElement.scrollTop+document.body.scrollTop;e>rollbox.eq(rolllen-1).offset().top+rollbox.eq(rolllen-1).height()?(0==$(".widgetRoller").length&&(rollbox.parent().append('<aside class="widgetRoller"></aside>'),rollbox.eq(asr_1-1).clone().appendTo(".widgetRoller"),asr_1!==asr_2&&rollbox.eq(asr_2-1).clone().appendTo(".widgetRoller"),$(".widgetRoller").css({position:"fixed",top:10,display:"none"})),sidebar_flying||$(".widgetRoller").fadeIn("normal"),sidebar_flying=!0):(sidebar_flying&&$(".widgetRoller").fadeOut("normal"),sidebar_flying=!1)})}$(document).on("click",".commentnav a",function(){var e=$(this).attr("href"),t=$(".commentshow"),n=$(this).parent().data("postid"),o=1,i=$("#cancel-comment-reply-link");/comment-page-/i.test(e)?o=e.split(/comment-page-/i)[1].split(/(\/|#|&).*jQuery/)[0]:/cpage=/i.test(e)&&(o=e.split(/cpage=/)[1].split(/(\/|#|&).*jQuery/)[0]),i.click(),o=o.split("#")[0];var a={action:"ajax_comment_page_nav",um_post:n,um_page:o};return t.html("<div>loading..</div>"),jQuery("body, html").animate({scrollTop:t.offset().top-150},1e3),jQuery.post(ajax.ajax_url,a,function(e){t.html(e),$("body, html").animate({scrollTop:t.offset().top-50},"normal")}),!1}),jQuery(document).on("click",".open-nav",function(){var e=$(document.body);e.hasClass("has-opened")?(e.removeClass("has-opened"),$("#mobile-nav").hide("fast")):($("#mobile-nav").show("fast"),e.addClass("has-opened"))}),jQuery(document).on("touchstart",".has-opened #wrap",closeMobileSidebar),jQuery(document).on("click","#mobile-nav li>a[href]",closeMobileSidebar),jQuery(document).ready(function(e){jQuery(".archives ul.archives-monthlisting").hide(),jQuery(".archives ul.archives-monthlisting:first").show(),jQuery(".archives .m-title").click(function(){return jQuery(this).next().slideToggle("fast"),!1}),add_views()});var $saying=$("#footer .saying-bottom"),saying_refresh=function(){$saying.html('<i class="fa fa-circle-o-notch fa-spin"></i> Refrshing...'),$.get("https://api.hzy.pw/saying/v1/ciba",function(e){var t='<i class="fa fa-paw" aria-hidden="true"></i> '+e.cn;$saying.hide().html(t).attr("title",e.en).fadeIn(1200)})};$saying.length&&(saying_refresh(),$saying.click(saying_refresh));
//by Lensual
var errorTimes=0;var preLoadBgImg_complete=false;var preLoadBgImg_complete_url="";var stopWatch_timeout=false;var bgImgUrlArr_length=0;var bgImgUrlArr_index={};for(var key in ajax.bgImgUrlArr){bgImgUrlArr_index[bgImgUrlArr_length++]=key}function preLoadBgImg(){var img=new Image();do{var url=ajax.bgImgUrlArr[bgImgUrlArr_index[Math.floor(Math.random()*bgImgUrlArr_length)]]}while($("body").css("background-image")=="url("+url+")");img.src=url;img.onerror=function(){console.error("Error on loading background-image:%o",url);onerror=null;errorTimes++;setTimeout("preLoadBgImg()",ajax.onerrorRetry)};img.onload=function(){onload=null;preLoadBgImg_complete_url=url;preLoadBgImg_complete=true;if(stopWatch_timeout||ajax.d_backgound_image_preload_b==""){switchBgImg()}}}function stopWatch(){stopWatch_timeout=true;if(preLoadBgImg_complete){switchBgImg()}}function switchBgImg(){$("body").css("background-image","url("+preLoadBgImg_complete_url+")");preLoadBgImg_complete=false;preLoadBgImg_complete_url="";stopWatch_timeout=false;if(ajax.d_backgound_image_preload_b!=""){setTimeout("stopWatch()",ajax.switchInterval);preLoadBgImg()}else{setTimeout("preLoadBgImg()",ajax.switchInterval)}};